@model List<LeaveViewModel>
@{
    ViewBag.Title = "All leaves";

}

<partial name="_LeaveConfirmationBsModal">

</partial>

<div class="module">
    <div class="module-head">
        <h3> All leaves</h3>
    </div>
    <div class="module-body table">
        <table 
            width="100%"
            class="table table-striped table-bordered dislay datatable-1">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Date From</th>
                    <th>Date To</th>
                    <th>Description</th>
                    <th>Type</th>
                    <th>Status</th>
                    <th>Reply</th>
                    <th>Approve/Reject</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var leave in Model)
                {
                    <tr>
                        <td>dummy user</td>
                        <td>@leave.From.ToShortDateString()</td>
                        <td>@leave.To.ToShortDateString()</td>
                        <td>@leave.Description</td>
                        <td>@(EnumHelper<Leave.LeaveType>.GetDisplayValue(leave.Leave))</td>
                        <td>
                            @{
                                var leaveStatus = leave.Reply?.Status;
                                string actionColor= "info";
                                switch(leaveStatus){
                                    case Reply.ReplyStatus.Approved:
                                        actionColor = "success";
                                        break;
                                    case Reply.ReplyStatus.Rejected:
                                        actionColor = "danger";
                                        break;
                                }
                            }
                            <span class="btn btn-@actionColor">@leave.Reply?.Status.ToString() </span>
                        </td>
                        <td>@leave.Reply?.Description</td>
                        <td>
                            <a href="#leave-request-decision" 
                                data-toggle="modal" 
                                data-title="Confirm"
                                data-leave="@leave.Id">Approve</a>
                                <span style="color: blue;">/</span>
                            <a href="#leave-request-decision" 
                                data-toggle="modal" 
                                data-title="Reject"
                                data-leave="@leave.Id">Reject</a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

@section Scripts {
    <partial name="_PagingJavascriptImports"></partial>
    <script>

       $('[data-toggle="modal"]').on('click', function() {
            var modal = $($(this).attr('href'));
            var title = $(this).data("title");
            modal.data('title', title);
            modal.data("leave", this.dataset.leave)
            switch(title){
                case "Confirm":
                    modal.data("options", [{Pending:1},{Approved:2}])
                    break;
                case "Reject":
                    modal.data("options",[{Rejected:3}])
                    break;
                default:
                    console.log("you will never see me");
            }
        });
    </script>
}   